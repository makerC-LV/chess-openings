{"id":"node_modules/chess/dist/simpleGameClient.js","dependencies":[{"name":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js.map","includedInParent":true,"mtime":499162500000},{"name":"/Users/shiva/VSCodeProjects/chess-openings/package.json","includedInParent":true,"mtime":1579734359778},{"name":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/package.json","includedInParent":true,"mtime":1579734224743},{"name":"@babel/runtime-corejs2/helpers/interopRequireDefault","loc":{"line":3,"column":37},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/interopRequireDefault.js"},{"name":"@babel/runtime-corejs2/core-js/object/define-property","loc":{"line":5,"column":37},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/core-js/object/define-property.js"},{"name":"@babel/runtime-corejs2/helpers/classCallCheck","loc":{"line":13,"column":54},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/classCallCheck.js"},{"name":"@babel/runtime-corejs2/helpers/createClass","loc":{"line":15,"column":51},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/createClass.js"},{"name":"@babel/runtime-corejs2/helpers/possibleConstructorReturn","loc":{"line":17,"column":65},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/possibleConstructorReturn.js"},{"name":"@babel/runtime-corejs2/helpers/getPrototypeOf","loc":{"line":19,"column":54},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/getPrototypeOf.js"},{"name":"@babel/runtime-corejs2/helpers/inherits","loc":{"line":21,"column":48},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/inherits.js"},{"name":"events","loc":{"line":23,"column":22},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/node_modules/events/events.js"},{"name":"./game","loc":{"line":25,"column":20},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js"},{"name":"./gameValidation","loc":{"line":27,"column":30},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/gameValidation.js"},{"name":"./piece","loc":{"line":29,"column":21},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/simpleGameClient.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/piece.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports[\"default\"] = exports.SimpleGameClient = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/inherits\"));\n\nvar _events = require(\"events\");\n\nvar _game = require(\"./game\");\n\nvar _gameValidation = require(\"./gameValidation\");\n\nvar _piece = require(\"./piece\");\n\n// private methods\nfunction isMoveValid(src, dest, validMoves) {\n  var i = 0,\n      isFound = function isFound(expr, sq) {\n    return typeof expr === 'string' && sq.file + sq.rank === expr || expr.rank && expr.file && sq.file === expr.file && sq.rank === expr.rank;\n  },\n      squares = [];\n\n  for (i = 0; i < validMoves.length; i++) {\n    if (isFound(src, validMoves[i].src)) {\n      squares = validMoves[i].squares;\n    }\n  }\n\n  if (squares && squares.length > 0) {\n    for (i = 0; i < squares.length; i++) {\n      if (isFound(dest, squares[i])) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction updateGameClient(gameClient) {\n  return gameClient.validation.start(function (err, result) {\n    if (err) {\n      throw new Error(err);\n    }\n\n    gameClient.isCheck = result.isCheck;\n    gameClient.isCheckmate = result.isCheckmate;\n    gameClient.isRepetition = result.isRepetition;\n    gameClient.isStalemate = result.isStalemate;\n    gameClient.validMoves = result.validMoves;\n  });\n} // ctor\n\n\nvar SimpleGameClient =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  (0, _inherits2[\"default\"])(SimpleGameClient, _EventEmitter);\n\n  function SimpleGameClient(game) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, SimpleGameClient);\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(SimpleGameClient).call(this));\n    _this.isCheck = false;\n    _this.isCheckmate = false;\n    _this.isRepetition = false;\n    _this.isStalemate = false;\n    _this.game = game;\n    _this.validMoves = [];\n    _this.validation = _gameValidation.GameValidation.create(_this.game); // bubble the game check event\n\n    _this.game.on('check', function (attackers) {\n      return _this.emit('check', attackers);\n    });\n\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(SimpleGameClient, [{\n    key: \"getStatus\",\n    value: function getStatus(forceUpdate) {\n      if (forceUpdate) {\n        updateGameClient(this);\n      }\n\n      return {\n        board: this.game.board,\n        isCheck: this.isCheck,\n        isCheckmate: this.isCheckmate,\n        isRepetition: this.isRepetition,\n        isStalemate: this.isStalemate,\n        validMoves: this.validMoves\n      };\n    }\n  }, {\n    key: \"move\",\n    value: function move(src, dest, promo) {\n      var move = null,\n          side = this.game.getCurrentSide();\n\n      if (src && dest && isMoveValid(src, dest, this.validMoves)) {\n        move = this.game.board.move(src, dest);\n\n        if (move) {\n          // apply pawn promotion if applicable\n          if (promo) {\n            var piece;\n\n            switch (promo) {\n              case 'B':\n                piece = _piece.Piece.createBishop(side);\n                break;\n\n              case 'N':\n                piece = _piece.Piece.createKnight(side);\n                break;\n\n              case 'Q':\n                piece = _piece.Piece.createQueen(side);\n                break;\n\n              case 'R':\n                piece = _piece.Piece.createRook(side);\n                break;\n\n              default:\n                piece = null;\n                break;\n            }\n\n            if (piece) {\n              this.game.board.promote(move.move.postSquare, piece);\n              /*\n              p.moveCount = move.move.postSquare.piece.moveCount;\n              move.move.postSquare.piece = p;\n              //*/\n            }\n          }\n\n          updateGameClient(this);\n          return move;\n        }\n      }\n\n      throw new Error(\"Move is invalid (\".concat(src, \" to \").concat(dest, \")\"));\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var game = _game.Game.create(),\n          gameClient = new SimpleGameClient(game);\n\n      updateGameClient(gameClient);\n      return gameClient;\n    }\n  }]);\n  return SimpleGameClient;\n}(_events.EventEmitter);\n\nexports.SimpleGameClient = SimpleGameClient;\nvar _default = {\n  SimpleGameClient: SimpleGameClient\n};\nexports[\"default\"] = _default;\n\n"},"sourceMaps":{"js":{"version":3,"sources":["simpleGameClient.js"],"names":["isMoveValid","src","dest","validMoves","i","isFound","expr","sq","file","rank","squares","length","updateGameClient","gameClient","validation","start","err","result","Error","isCheck","isCheckmate","isRepetition","isStalemate","SimpleGameClient","game","GameValidation","create","on","attackers","emit","forceUpdate","board","promo","move","side","getCurrentSide","piece","Piece","createBishop","createKnight","createQueen","createRook","promote","postSquare","Game","EventEmitter"],"mappings":"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","sourcesContent":["import { EventEmitter } from 'events';\nimport { Game } from './game';\nimport { GameValidation } from './gameValidation';\nimport { Piece } from './piece';\n\n// private methods\nfunction isMoveValid (src, dest, validMoves) {\n\tlet\n\t\ti = 0,\n\t\tisFound = (expr, sq) => {\n\t\t\treturn ((typeof expr === 'string' && sq.file + sq.rank === expr) ||\n\t\t\t\t(expr.rank && expr.file &&\n\t\t\t\t\tsq.file === expr.file && sq.rank === expr.rank));\n\t\t},\n\t\tsquares = [];\n\n\tfor (i = 0; i < validMoves.length; i++) {\n\t\tif (isFound(src, validMoves[i].src)) {\n\t\t\tsquares = validMoves[i].squares;\n\t\t}\n\t}\n\n\tif (squares && squares.length > 0) {\n\t\tfor (i = 0; i < squares.length; i++) {\n\t\t\tif (isFound(dest, squares[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction updateGameClient (gameClient) {\n\treturn gameClient.validation.start((err, result) => {\n\t\tif (err) {\n\t\t\tthrow new Error(err);\n\t\t}\n\n\t\tgameClient.isCheck = result.isCheck;\n\t\tgameClient.isCheckmate = result.isCheckmate;\n\t\tgameClient.isRepetition = result.isRepetition;\n\t\tgameClient.isStalemate = result.isStalemate;\n\t\tgameClient.validMoves = result.validMoves;\n\t});\n}\n\n// ctor\nexport class SimpleGameClient extends EventEmitter {\n\tconstructor (game) {\n\t\tsuper();\n\n\t\tthis.isCheck = false;\n\t\tthis.isCheckmate = false;\n\t\tthis.isRepetition = false;\n\t\tthis.isStalemate = false;\n\t\tthis.game = game;\n\t\tthis.validMoves = [];\n\t\tthis.validation = GameValidation.create(this.game);\n\n\t\t// bubble the game check event\n\t\tthis.game.on('check', (attackers) => (this.emit('check', attackers)));\n\t}\n\n\tstatic create () {\n\t\tlet\n\t\t\tgame = Game.create(),\n\t\t\tgameClient = new SimpleGameClient(game);\n\n\t\tupdateGameClient(gameClient);\n\n\t\treturn gameClient;\n\t}\n\n\tgetStatus (forceUpdate) {\n\t\tif (forceUpdate) {\n\t\t\tupdateGameClient(this);\n\t\t}\n\n\t\treturn {\n\t\t\tboard : this.game.board,\n\t\t\tisCheck : this.isCheck,\n\t\t\tisCheckmate : this.isCheckmate,\n\t\t\tisRepetition : this.isRepetition,\n\t\t\tisStalemate : this.isStalemate,\n\t\t\tvalidMoves : this.validMoves\n\t\t};\n\t}\n\n\tmove (src, dest, promo) {\n\t\tlet\n\t\t\tmove = null,\n\t\t\tside = this.game.getCurrentSide();\n\n\tif (src && dest && isMoveValid(src, dest, this.validMoves)) {\n\t\tmove = this.game.board.move(src, dest);\n\n\t\tif (move) {\n\t\t\t// apply pawn promotion if applicable\n\t\t\tif (promo) {\n\t\t\t\tlet piece;\n\n\t\t\t\tswitch (promo) {\n\t\t\t\t\tcase 'B':\n\t\t\t\t\t\tpiece = Piece.createBishop(side);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'N':\n\t\t\t\t\t\tpiece = Piece.createKnight(side);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Q':\n\t\t\t\t\t\tpiece = Piece.createQueen(side);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'R':\n\t\t\t\t\t\tpiece = Piece.createRook(side);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tpiece = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (piece) {\n\t\t\t\t\tthis.game.board.promote(move.move.postSquare, piece);\n\t\t\t\t\t/*\n\t\t\t\t\tp.moveCount = move.move.postSquare.piece.moveCount;\n\t\t\t\t\tmove.move.postSquare.piece = p;\n\t\t\t\t\t//*/\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tupdateGameClient(this);\n\t\t\treturn move;\n\t\t}\n\t}\n\n\tthrow new Error(`Move is invalid (${ src } to ${ dest })`);\n\t}\n}\n\nexport default { SimpleGameClient };\n"],"file":"simpleGameClient.js"}},"error":null,"hash":"c09aa03e0eba6268b8ae1f3e37011ed9","cacheData":{"env":{}}}