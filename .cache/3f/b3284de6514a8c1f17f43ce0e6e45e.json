{"id":"node_modules/chess/dist/game.js","dependencies":[{"name":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js.map","includedInParent":true,"mtime":499162500000},{"name":"/Users/shiva/VSCodeProjects/chess-openings/package.json","includedInParent":true,"mtime":1579734359778},{"name":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/package.json","includedInParent":true,"mtime":1579734224743},{"name":"@babel/runtime-corejs2/helpers/interopRequireDefault","loc":{"line":3,"column":37},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/interopRequireDefault.js"},{"name":"@babel/runtime-corejs2/core-js/object/define-property","loc":{"line":5,"column":37},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/core-js/object/define-property.js"},{"name":"@babel/runtime-corejs2/helpers/classCallCheck","loc":{"line":13,"column":54},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/classCallCheck.js"},{"name":"@babel/runtime-corejs2/helpers/createClass","loc":{"line":15,"column":51},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/createClass.js"},{"name":"@babel/runtime-corejs2/helpers/possibleConstructorReturn","loc":{"line":17,"column":65},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/possibleConstructorReturn.js"},{"name":"@babel/runtime-corejs2/helpers/getPrototypeOf","loc":{"line":19,"column":54},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/getPrototypeOf.js"},{"name":"@babel/runtime-corejs2/helpers/inherits","loc":{"line":21,"column":48},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/@babel/runtime-corejs2/helpers/inherits.js"},{"name":"./board","loc":{"line":23,"column":21},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/board.js"},{"name":"crypto","loc":{"line":25,"column":45},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/node_modules/crypto-browserify/index.js"},{"name":"events","loc":{"line":27,"column":22},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/node_modules/events/events.js"},{"name":"./piece","loc":{"line":29,"column":21},"parent":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/game.js","resolved":"/Users/shiva/VSCodeProjects/chess-openings/node_modules/chess/dist/piece.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports[\"default\"] = exports.Move = exports.Game = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/inherits\"));\n\nvar _board = require(\"./board\");\n\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\n\nvar _events = require(\"events\");\n\nvar _piece = require(\"./piece\");\n\n/**\n\tGames contain the history of a board and the board itself.\n\n\tAt time of writing this, the game is also intended to store some\n\tdegree of information regarding the opponents and keys that\n\tcould be used for storage, etc.\n*/\nfunction addToHistory(game) {\n  return function (ev) {\n    var hashCode = game.getHashCode(),\n        move = new Move(ev.prevSquare, ev.postSquare, ev.capturedPiece, ev.algebraic, hashCode);\n    game.moveHistory.push(move);\n  };\n}\n\nfunction denotePromotionInHistory(game) {\n  return function () {\n    var latest = game.moveHistory[game.moveHistory.length - 1];\n\n    if (latest) {\n      latest.promotion = true;\n    }\n  };\n}\n\nvar Game =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  (0, _inherits2[\"default\"])(Game, _EventEmitter);\n\n  function Game(board) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, Game);\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(Game).call(this));\n    _this.board = board;\n    _this.moveHistory = [];\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(Game, [{\n    key: \"getCurrentSide\",\n    value: function getCurrentSide() {\n      return this.moveHistory.length % 2 === 0 ? _piece.SideType.White : _piece.SideType.Black;\n    }\n  }, {\n    key: \"getHashCode\",\n    value: function getHashCode() {\n      var i = 0,\n          sum = _crypto[\"default\"].createHash('md5');\n\n      for (i = 0; i < this.board.squares.length; i++) {\n        if (this.board.squares[i].piece !== null) {\n          sum.update(this.board.squares[i].file + this.board.squares[i].rank + (this.board.squares[i].piece.side === _piece.SideType.White ? 'w' : 'b') + this.board.squares[i].piece.notation + (i < this.board.squares.length - 1 ? '-' : ''));\n        }\n      } // generate hash code for board\n\n\n      return sum.digest('base64');\n    }\n  }], [{\n    key: \"create\",\n    value: function create() {\n      var board = _board.Board.create(),\n          game = new Game(board); // handle move and promotion events correctly\n\n\n      board.on('move', addToHistory(game));\n      board.on('promote', denotePromotionInHistory(game));\n      return game;\n    }\n  }, {\n    key: \"load\",\n    value: function load(moveHistory) {\n      var board = _board.Board.create(),\n          game = new Game(),\n          i = 0; // handle move and promotion events correctly\n\n\n      board.on('move', addToHistory(game));\n      board.on('promote', denotePromotionInHistory(game)); // apply move history\n\n      for (i = 0; i < moveHistory.length; i++) {\n        board.move(board.getSquare(moveHistory[i].prevFile, moveHistory[i].prevRank), board.getSquare(moveHistory[i].postFile, moveHistory[i].postRank));\n      }\n\n      return game;\n    }\n  }]);\n  return Game;\n}(_events.EventEmitter);\n\nexports.Game = Game;\n\nvar Move = function Move(originSquare, targetSquare, capturedPiece, notation, hash) {\n  (0, _classCallCheck2[\"default\"])(this, Move);\n  this.algebraic = notation;\n  this.capturedPiece = capturedPiece;\n  this.hashCode = hash;\n  this.piece = targetSquare.piece;\n  this.promotion = false;\n  this.postFile = targetSquare.file;\n  this.postRank = targetSquare.rank;\n  this.prevFile = originSquare.file;\n  this.prevRank = originSquare.rank;\n};\n\nexports.Move = Move;\nvar _default = {\n  Game: Game,\n  Move: Move\n};\nexports[\"default\"] = _default;\n\n"},"sourceMaps":{"js":{"version":3,"sources":["game.js"],"names":["addToHistory","game","ev","hashCode","getHashCode","move","Move","prevSquare","postSquare","capturedPiece","algebraic","moveHistory","push","denotePromotionInHistory","latest","length","promotion","Game","board","SideType","White","Black","i","sum","crypto","createHash","squares","piece","update","file","rank","side","notation","digest","Board","create","on","getSquare","prevFile","prevRank","postFile","postRank","EventEmitter","originSquare","targetSquare","hash"],"mappings":"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","sourcesContent":["/**\n\tGames contain the history of a board and the board itself.\n\n\tAt time of writing this, the game is also intended to store some\n\tdegree of information regarding the opponents and keys that\n\tcould be used for storage, etc.\n*/\nimport { Board } from './board';\nimport crypto from 'crypto';\nimport { EventEmitter } from 'events';\nimport { SideType } from './piece';\n\nfunction addToHistory (game) {\n\treturn (ev) => {\n\t\tlet\n\t\t\thashCode = game.getHashCode(),\n\t\t\tmove = new Move(\n\t\t\t\tev.prevSquare,\n\t\t\t\tev.postSquare,\n\t\t\t\tev.capturedPiece,\n\t\t\t\tev.algebraic,\n\t\t\t\thashCode);\n\n\t\tgame.moveHistory.push(move);\n\t};\n}\n\nfunction denotePromotionInHistory (game) {\n\treturn () => {\n\t\tlet\n\t\t\tlatest = game.moveHistory[\n\t\t\tgame.moveHistory.length - 1];\n\n\t\tif (latest) {\n\t\t\tlatest.promotion = true;\n\t\t}\n\t};\n}\n\nexport class Game extends EventEmitter {\n\tconstructor (board) {\n\t\tsuper();\n\n\t\tthis.board = board;\n\t\tthis.moveHistory = [];\n\t}\n\n\tstatic create () {\n\t\tlet\n\t\t\tboard = Board.create(),\n\t\t\tgame = new Game(board);\n\n\t\t// handle move and promotion events correctly\n\t\tboard.on('move', addToHistory(game));\n\t\tboard.on('promote', denotePromotionInHistory(game));\n\n\t\treturn game;\n\t}\n\n\tgetCurrentSide () {\n\t\treturn this.moveHistory.length % 2 === 0 ?\n\t\t\tSideType.White :\n\t\t\tSideType.Black;\n\t}\n\n\tgetHashCode () {\n\t\tlet\n\t\t\ti = 0,\n\t\t\tsum = crypto.createHash('md5');\n\n\t\tfor (i = 0; i < this.board.squares.length; i++) {\n\t\t\tif (this.board.squares[i].piece !== null) {\n\t\t\t\tsum.update(this.board.squares[i].file +\n\t\t\t\t\tthis.board.squares[i].rank +\n\t\t\t\t\t(this.board.squares[i].piece.side === SideType.White ? 'w' : 'b') +\n\t\t\t\t\tthis.board.squares[i].piece.notation +\n\t\t\t\t\t(i < (this.board.squares.length - 1) ? '-' : ''));\n\t\t\t}\n\t\t}\n\n\t\t// generate hash code for board\n\t\treturn sum.digest('base64');\n\t}\n\n\tstatic load (moveHistory) {\n\t\tlet\n\t\t\tboard = Board.create(),\n\t\t\tgame = new Game(),\n\t\t\ti = 0;\n\n\t\t// handle move and promotion events correctly\n\t\tboard.on('move', addToHistory(game));\n\t\tboard.on('promote', denotePromotionInHistory(game));\n\n\t\t// apply move history\n\t\tfor (i = 0; i < moveHistory.length; i++) {\n\t\t\tboard.move(\n\t\t\t\tboard.getSquare(\n\t\t\t\t\tmoveHistory[i].prevFile,\n\t\t\t\t\tmoveHistory[i].prevRank),\n\t\t\t\tboard.getSquare(\n\t\t\t\t\tmoveHistory[i].postFile,\n\t\t\t\t\tmoveHistory[i].postRank));\n\t\t}\n\n\t\treturn game;\n\t}\n}\n\nexport class Move {\n\tconstructor (originSquare, targetSquare, capturedPiece, notation, hash) {\n\t\tthis.algebraic = notation;\n\t\tthis.capturedPiece = capturedPiece;\n\t\tthis.hashCode = hash;\n\t\tthis.piece = targetSquare.piece;\n\t\tthis.promotion = false;\n\t\tthis.postFile = targetSquare.file;\n\t\tthis.postRank = targetSquare.rank;\n\t\tthis.prevFile = originSquare.file;\n\t\tthis.prevRank = originSquare.rank;\n\t}\n}\n\nexport default { Game, Move };\n"],"file":"game.js"}},"error":null,"hash":"fea95ec21492848927c4730ee1963816","cacheData":{"env":{}}}